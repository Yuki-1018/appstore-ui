<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.min.css">
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
  <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>
  <script src="apps.json"></script>
  <style>
    .app-card {
      margin: 10px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      cursor: pointer;
    }

    .download-page {
      display: none;
      padding: 20px;
    }

    .close-btn {
      text-align: center;
      margin-top: 20px;
    }

    @media screen and (max-width: 600px) {
      .app-card {
        width: 90%;
        margin: 10px auto;
      }
    }
  </style>
</head>
<body>

  <ons-page>
    <ons-toolbar>
      <div class="center">AppStore</div>
    </ons-toolbar>

    <ons-list>
      <ons-list-header>App List</ons-list-header>
      <div id="app-list"></div>
    </ons-list>
  </ons-page>

  <ons-template id="download-page.html">
    <ons-page id="download-page">
      <ons-toolbar>
        <div class="left">
          <ons-back-button>Back</ons-back-button>
        </div>
        <div class="center">Download Page</div>
      </ons-toolbar>

      <div class="download-page">
        <h2 id="app-title"></h2>
        <img id="app-icon" style="width: 100px; height: 100px;" alt="App Icon">
        <p>Download link: <a id="download-link" target="_blank">Download</a></p>
      </div>

      <div class="close-btn">
        <ons-button onclick="closeDownloadPage()">Close</ons-button>
      </div>
    </ons-page>
  </ons-template>

  <script>
    document.addEventListener('init', function(event) {
      if (event.target.id === 'download-page') {
        const appTitle = document.getElementById('app-title');
        const appIcon = document.getElementById('app-icon');
        const downloadLink = document.getElementById('download-link');

        const appId = event.target.data.appId;
        const appData = getAppDataById(appId);

        appTitle.innerText = appData.name;
        appIcon.src = appData.icon;
        downloadLink.href = appData.downloadLink;
      }
    });

    function closeDownloadPage() {
      document.getElementById('download-page').hide();
    }

    function showDownloadPage(appId) {
      const nav = document.getElementById('navigator');
      const downloadPage = document.getElementById('download-page.html');

      nav.pushPage(downloadPage, { data: { appId } });
    }

    function renderAppList() {
      const appListContainer = document.getElementById('app-list');
      const fragment = document.createDocumentFragment();

      for (const appData of appDataList) {
        const appCard = document.createElement('div');
        appCard.classList.add('app-card');
        appCard.innerHTML = `
          <ons-card onclick="showDownloadPage('${appData.id}')">
            <div class="title">${appData.name}</div>
            <div class="content">${appData.description}</div>
          </ons-card>
        `;
        fragment.appendChild(appCard);
      }

      appListContainer.appendChild(fragment);
    }

    document.addEventListener('DOMContentLoaded', function() {
      renderAppList();
    });
  </script>
</body>
</html>
